<!DOCTYPE html>
<html lang="me">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}AI Vlada Crne Gore{% endblock %}</title>
  <link rel="stylesheet" href="{{ css_path | default('/static/css/style.css') }}">
  {% block head %}{% endblock %}
</head>
<body>
  <div class="layout">
    <!-- Mobile-only top bar -->
    <header class="mobile-header">
      <a href="{{ base_path | default('/') }}" class="site-title">
        &#127474;&#127466; <span class="lang-mne">AI Vlada CG</span><span class="lang-en">AI Gov MNE</span>
      </a>
      <button class="hamburger" id="hamburger" aria-label="Toggle navigation" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
    </header>

    <!-- Fixed left sidebar -->
    <aside class="sidebar" id="sidebar">
      <a href="{{ base_path | default('/') }}" class="site-title">
        &#127474;&#127466; <span class="lang-mne">AI Vlada</span><span class="lang-en">AI Government</span>
      </a>
      <nav>
        <ul>
          <li><a href="{{ base_path | default('/') }}analyses/"><span class="lang-mne">Analize</span><span class="lang-en">Analyses</span></a></li>
          <li><a href="{{ base_path | default('/') }}constitution/"><span class="lang-mne">Ustav</span><span class="lang-en">Constitution</span></a></li>
          <li><a href="{{ base_path | default('/') }}cabinet/"><span class="lang-mne">Kabinet</span><span class="lang-en">Cabinet</span></a></li>
          <li><a href="{{ base_path | default('/') }}challenges/"><span class="lang-mne">Izazovi</span><span class="lang-en">Challenges</span></a></li>
          <li><a href="{{ base_path | default('/') }}transparency/"><span class="lang-mne">Transparentnost</span><span class="lang-en">Transparency</span></a></li>
          <li><a href="{{ base_path | default('/') }}architecture/"><span class="lang-mne">Arhitektura</span><span class="lang-en">Architecture</span></a></li>
          <li><a href="{{ base_path | default('/') }}news/"><span class="lang-mne">Vijesti</span><span class="lang-en">News</span></a></li>
        </ul>
      </nav>
      <div class="lang-toggle">
        <button data-lang="mne" class="active">ME</button>
        <button data-lang="en">EN</button>
      </div>
    </aside>

    <!-- Scrollable content area -->
    <div class="content">
      <main>
        {% block content %}{% endblock %}
      </main>

      <footer>
        <p class="lang-mne">AI Vlada Crne Gore &mdash; Nezavisna AI analiza vladinih odluka u javnom interesu.</p>
        <p class="lang-en">AI Government of Montenegro &mdash; Independent AI analysis of government decisions in the public interest.</p>
        <p class="lang-mne">Izvorni kod: <a href="https://github.com/vindl/ai-government">github.com/vindl/ai-government</a></p>
        <p class="lang-en">Source code: <a href="https://github.com/vindl/ai-government">github.com/vindl/ai-government</a></p>
      </footer>
    </div>
  </div>

  <script>
  (function() {
    // Language toggle
    var STORAGE_KEY = 'aigov-lang';
    function getLang() {
      return localStorage.getItem(STORAGE_KEY) || 'mne';
    }
    function setLang(lang) {
      localStorage.setItem(STORAGE_KEY, lang);
      document.documentElement.setAttribute('data-lang', lang);
      var btns = document.querySelectorAll('.lang-toggle button');
      for (var i = 0; i < btns.length; i++) {
        btns[i].classList.toggle('active', btns[i].getAttribute('data-lang') === lang);
      }
    }

    // Sidebar toggle
    var hamburger = document.getElementById('hamburger');
    function closeSidebar() {
      document.body.classList.remove('sidebar-open');
      hamburger.setAttribute('aria-expanded', 'false');
    }
    function toggleSidebar() {
      var open = document.body.classList.toggle('sidebar-open');
      hamburger.setAttribute('aria-expanded', String(open));
    }

    document.addEventListener('DOMContentLoaded', function() {
      setLang(getLang());
      document.addEventListener('click', function(e) {
        if (e.target.matches('.lang-toggle button')) {
          setLang(e.target.getAttribute('data-lang'));
        }
      });
      hamburger.addEventListener('click', function(e) {
        e.stopPropagation();
        toggleSidebar();
      });
      document.addEventListener('click', function(e) {
        if (document.body.classList.contains('sidebar-open') &&
            !document.getElementById('sidebar').contains(e.target)) {
          closeSidebar();
        }
      });
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && document.body.classList.contains('sidebar-open')) {
          closeSidebar();
        }
      });
    });
  })();
  </script>
</body>
</html>
